delta = pct_passed-eb_estimate) %>%
arrange(eb_estimate) %>%
mutate(`Original Sponsor` = as.factor(`Original Sponsor`))
bills_eb
ggplot(bills_eb) +
geom_segment( aes(x=`Original Sponsor`, xend=`Original Sponsor`, y=eb_estimate, yend=pct_passed), color="grey") +
geom_point( aes(x=x, y=value1), color=rgb(0.2,0.7,0.1,0.5), size=3 ) +
geom_point( aes(x=x, y=value2), color=rgb(0.7,0.2,0.1,0.5), size=3 ) +
coord_flip()
ggplot(bills_eb) +
geom_segment( aes(x=`Original Sponsor`, xend=`Original Sponsor`, y=eb_estimate, yend=pct_passed), color="grey") +
geom_point( aes(x=`Original Sponsor`, y=eb_estimate), color=rgb(0.2,0.7,0.1,0.5), size=3 ) +
geom_point( aes(x=`Original Sponsor`, y=pct_passed), color=rgb(0.7,0.2,0.1,0.5), size=3 ) +
coord_flip()
g3 <- ggplot(bills_eb, aes(x = pct_passed, y = eb_estimate, color = Party, label = `Original Sponsor`))+
geom_jitter() +
labs(title = "Overall Bill Passage",
y = "Bills not passing",
x = "Bills passing") +
theme_modern_rc() +
scale_color_manual(breaks = c("D", "R"),
values=c("blue", "red"))
ggplotly(g3)
g3 <- ggplot(bills_eb, aes(x = pct_passed, y = eb_estimate, color = Party, label = `Original Sponsor`))+
geom_jitter() +
labs(title = "Overall Bill Passage",
y = "Bayesian estimate",
x = "Observed of bills passed") +
theme_modern_rc() +
scale_color_manual(breaks = c("D", "R"),
values=c("blue", "red"))
ggplotly(g3)
bills_eb
g3 <- ggplot(bills_eb, aes(x = pct_passed, y = eb_estimate, color = Party, label = `Original Sponsor`, size = tot_bills))+
geom_jitter() +
labs(title = "Overall Bill Passage",
y = "Bayesian estimate",
x = "Observed of bills passed") +
theme_modern_rc() +
scale_color_manual(breaks = c("D", "R"),
values=c("blue", "red"))
ggplotly(g3)
g3 <- ggplot(bills_eb, aes(x = pct_passed, y = eb_estimate, color = Party, label = `Original Sponsor`, size = tot_bills))+
geom_jitter(shape = f) +
labs(title = "Overall Bill Passage",
y = "Bayesian estimate",
x = "Observed of bills passed") +
theme_modern_rc() +
scale_color_manual(breaks = c("D", "R"),
values=c("blue", "red"))
ggplotly(g3)
g3 <- ggplot(bills_eb, aes(x = pct_passed, y = eb_estimate, color = Party, label = `Original Sponsor`, size = tot_bills))+
geom_jitter(aes(shape = f)) +
labs(title = "Overall Bill Passage",
y = "Bayesian estimate",
x = "Observed of bills passed") +
theme_modern_rc() +
scale_color_manual(breaks = c("D", "R"),
values=c("blue", "red"))
ggplotly(g3)
g3 <- ggplot(bills_eb, aes(x = pct_passed, y = eb_estimate, color = Party, label = `Original Sponsor`, size = tot_bills))+
geom_jitter(mapping = aes(shape = f)) +
labs(title = "Overall Bill Passage",
y = "Bayesian estimate",
x = "Observed of bills passed") +
theme_modern_rc() +
scale_color_manual(breaks = c("D", "R"),
values=c("blue", "red"))
ggplotly(g3)
g3 <- ggplot(bills_eb, aes(x = pct_passed, y = eb_estimate, color = Party, label = `Original Sponsor`, size = tot_bills))+
geom_jitter(alpha = 1/10) +
labs(title = "Overall Bill Passage",
y = "Bayesian estimate",
x = "Observed of bills passed") +
theme_modern_rc() +
scale_color_manual(breaks = c("D", "R"),
values=c("blue", "red"))
ggplotly(g3)
g3 <- ggplot(bills_eb, aes(x = pct_passed, y = eb_estimate, color = Party, label = `Original Sponsor`, size = tot_bills))+
geom_jitter(alpha = 1/2) +
labs(title = "Overall Bill Passage",
y = "Bayesian estimate",
x = "Observed of bills passed") +
theme_modern_rc() +
scale_color_manual(breaks = c("D", "R"),
values=c("blue", "red"))
ggplotly(g3)
g3 <- ggplot(bills_eb, aes(x = pct_passed, y = eb_estimate, color = Party, label = `Original Sponsor`, size = tot_bills))+
geom_jitter(alpha = 3/4) +
labs(title = "Overall Bill Passage",
y = "Bayesian estimate",
x = "Observed of bills passed") +
theme_modern_rc() +
scale_color_manual(breaks = c("D", "R"),
values=c("blue", "red"))
ggplotly(g3)
g3 <- ggplot(bills_eb, aes(x = pct_passed, y = eb_estimate, color = Party, label = `Original Sponsor`, size = tot_bills))+
geom_jitter(alpha = 3/4) +
labs(title = "Overall Bill Passage",
y = "Bayesian estimate",
x = "Observed percentage of bills passed") +
geom_abline(intercept = 0, slope = 1) +
theme_modern_rc() +
scale_color_manual(breaks = c("D", "R"),
values=c("blue", "red"))
ggplotly(g3)
g3 <- ggplot(bills_eb, aes(x = pct_passed, y = eb_estimate, color = Party, label = `Original Sponsor`, size = tot_bills))+
geom_jitter(alpha = 3/4) +
labs(title = "Overall Bill Passage",
y = "Bayesian estimate",
x = "Observed percentage of bills passed") +
geom_abline(intercept = 0, slope = 1, aes(color = "lightgray")) +
theme_modern_rc() +
scale_color_manual(breaks = c("D", "R"),
values=c("blue", "red"))
ggplotly(g3)
g3 <- ggplot(bills_eb, aes(x = pct_passed, y = eb_estimate, color = Party, label = `Original Sponsor`, size = tot_bills))+
geom_jitter(alpha = 3/4) +
labs(title = "Overall Bill Passage",
y = "Bayesian estimate",
x = "Observed percentage of bills passed") +
geom_abline(intercept = 0, slope = 1, aes(color = "blue")) +
theme_modern_rc() +
scale_color_manual(breaks = c("D", "R"),
values=c("blue", "red"))
ggplotly(g3)
g3 <- ggplot(bills_eb, aes(x = pct_passed, y = eb_estimate, color = Party, label = `Original Sponsor`, size = tot_bills))+
geom_jitter(alpha = 3/4) +
labs(title = "Overall Bill Passage",
y = "Bayesian estimate",
x = "Observed percentage of bills passed") +
geom_abline(intercept = 0, slope = 1, color = "lightgray", alpha = .5) +
theme_modern_rc() +
scale_color_manual(breaks = c("D", "R"),
values=c("blue", "red"))
ggplotly(g3)
bills_eb
g3 <- ggplot(bills_eb, aes(x = pct_passed, y = eb_estimate, color = Party, label = c(`Original Sponsor`, passed, not_passed), size = tot_bills))+
geom_jitter(alpha = 3/4) +
labs(title = "Overall Bill Passage",
y = "Bayesian estimate",
x = "Observed percentage of bills passed") +
geom_abline(intercept = 0, slope = 1, color = "lightgray", alpha = .5) +
theme_modern_rc() +
scale_color_manual(breaks = c("D", "R"),
values=c("blue", "red"))
ggplotly(g3)
g3 <- ggplot(bills_eb, aes(x = pct_passed, y = eb_estimate, color = Party, label = `Original Sponsor`, label2 = passed, label3 = not_passed), size = tot_bills)+
geom_jitter(alpha = 3/4) +
labs(title = "Overall Bill Passage",
y = "Bayesian estimate",
x = "Observed percentage of bills passed") +
geom_abline(intercept = 0, slope = 1, color = "lightgray", alpha = .5) +
theme_modern_rc() +
scale_color_manual(breaks = c("D", "R"),
values=c("blue", "red"))
ggplotly(g3)
g3 <- ggplot(bills_eb, aes(x = pct_passed, y = eb_estimate, color = Party, label = `Original Sponsor`, label2 = passed, label3 = not_passed, size = tot_bills)) +
geom_jitter(alpha = 3/4) +
labs(title = "Overall Bill Passage",
y = "Bayesian estimate",
x = "Observed percentage of bills passed") +
geom_abline(intercept = 0, slope = 1, color = "lightgray", alpha = .5) +
theme_modern_rc() +
scale_color_manual(breaks = c("D", "R"),
values=c("blue", "red"))
ggplotly(g3)
g3 <- ggplot(bills_eb, aes(x = pct_passed, y = eb_estimate, color = Party, label = `Original Sponsor`, label2 = passed, label3 = not_passed, alpha() = tot_bills)) +
geom_jitter() +
labs(title = "Overall Bill Passage",
y = "Bayesian estimate",
x = "Observed percentage of bills passed") +
geom_abline(intercept = 0, slope = 1, color = "lightgray", alpha = .5) +
theme_modern_rc() +
scale_color_manual(breaks = c("D", "R"),
values=c("blue", "red"))
ggplotly(g3)
g3 <- ggplot(bills_eb, aes(x = pct_passed, y = eb_estimate, color = Party, label = `Original Sponsor`, label2 = passed, label3 = not_passed, alpha = tot_bills)) +
geom_jitter() +
labs(title = "Overall Bill Passage",
y = "Bayesian estimate",
x = "Observed percentage of bills passed") +
geom_abline(intercept = 0, slope = 1, color = "lightgray", alpha = .5) +
theme_modern_rc() +
scale_color_manual(breaks = c("D", "R"),
values=c("blue", "red"))
ggplotly(g3)
g3 <- ggplot(bills_eb, aes(x = pct_passed, y = eb_estimate, shape = Party, label = `Original Sponsor`, label2 = passed, label3 = not_passed, color = tot_bills)) +
geom_jitter() +
labs(title = "Overall Bill Passage",
y = "Bayesian estimate",
x = "Observed percentage of bills passed") +
geom_abline(intercept = 0, slope = 1, color = "lightgray", alpha = .5) +
theme_modern_rc() +
scale_color_manual(breaks = c("D", "R"),
values=c("blue", "red"))
ggplotly(g3)
g3 <- ggplot(bills_eb, aes(x = pct_passed, y = eb_estimate, shape = Party, label = `Original Sponsor`, label2 = passed, label3 = not_passed, color = tot_bills)) +
geom_jitter() +
scale_color_viridis_c()+
labs(title = "Overall Bill Passage",
y = "Bayesian estimate",
x = "Observed percentage of bills passed") +
geom_abline(intercept = 0, slope = 1, color = "lightgray", alpha = .5) +
theme_modern_rc() +
scale_color_manual(breaks = c("D", "R"),
values=c("blue", "red"))
ggplotly(g3)
g3 <- ggplot(bills_eb, aes(x = pct_passed, y = eb_estimate, label = `Original Sponsor`, label2 = passed, label3 = not_passed, color = tot_bills)) +
geom_jitter() +
scale_color_viridis_c()+
labs(title = "Overall Bill Passage",
y = "Bayesian estimate",
x = "Observed percentage of bills passed") +
geom_abline(intercept = 0, slope = 1, color = "lightgray", alpha = .5) +
theme_modern_rc() +
scale_color_manual(breaks = c("D", "R"),
values=c("blue", "red"))
ggplotly(g3)
ggplotly(g3)
g3 <- ggplot(bills_eb, aes(x = pct_passed, y = eb_estimate, label = `Original Sponsor`, label2 = passed, label3 = not_passed)) +
geom_jitter() +
scale_color_viridis_c()+
labs(title = "Overall Bill Passage",
y = "Bayesian estimate",
x = "Observed percentage of bills passed") +
geom_abline(intercept = 0, slope = 1, color = "lightgray", alpha = .5) +
theme_modern_rc() +
scale_color_manual(breaks = c("D", "R"),
values=c("blue", "red"))
ggplotly(g3)
g3 <- ggplot(bills_eb, aes(x = pct_passed, y = eb_estimate, label = `Original Sponsor`, label2 = passed, label3 = not_passed, color = tot_bills)) +
geom_jitter() +
scale_color_viridis_c() +
labs(title = "Overall Bill Passage",
y = "Bayesian estimate",
x = "Observed percentage of bills passed") +
geom_abline(intercept = 0, slope = 1, color = "lightgray", alpha = .5) +
theme_modern_rc()
ggplotly(g3)
bills_eb
g3 <- ggplot(bills_eb, aes(x = pct_passed, y = eb_estimate, label = `Original Sponsor`, label2 = passed, label3 = not_passed, color = tot_bills, shape = Party)) +
geom_jitter() +
scale_color_viridis_c() +
labs(title = "Overall Bill Passage",
y = "Bayesian estimate",
x = "Observed percentage of bills passed") +
geom_abline(intercept = 0, slope = 1, color = "lightgray", alpha = .5) +
theme_modern_rc()
ggplotly(g3)
g3 <- ggplot(bills_eb, aes(x = pct_passed, y = eb_estimate, label = `Original Sponsor`, label2 = passed, label3 = not_passed, color = tot_bills)) +
geom_point() +
scale_color_viridis_c() +
labs(title = "Overall Bill Passage",
y = "Bayesian estimate",
x = "Observed percentage of bills passed") +
geom_abline(intercept = 0, slope = 1, color = "lightgray", alpha = .5) +
theme_modern_rc()
ggplotly(g3)
g3 <- ggplot(bills_eb, aes(x = pct_passed, y = eb_estimate, label = `Original Sponsor`, label2 = passed, label3 = not_passed, color = tot_bills)) +
geom_point() +
scale_color_viridis_c() +
scale_y_continuous(labels = scales::percent) +
scale_x_continuous(labels = scales::percent) +
labs(title = "Overall Bill Passage",
y = "Bayesian estimate",
x = "Observed percentage of bills passed",
) +
geom_abline(intercept = 0, slope = 1, color = "lightgray", alpha = .5) +
theme_modern_rc()
ggplotly(g3)
g3 <- ggplot(bills_eb, aes(x = pct_passed, y = eb_estimate, label = `Original Sponsor`, label2 = passed, label3 = not_passed, color = tot_bills)) +
geom_point() +
scale_color_viridis_c(name = "Total Bills Introduced") +
scale_y_continuous(labels = scales::percent) +
scale_x_continuous(labels = scales::percent) +
labs(title = "Overall Bill Passage",
y = "Bayesian estimate",
x = "Observed percentage of bills passed") +
geom_abline(intercept = 0, slope = 1, color = "lightgray", alpha = .5) +
theme_modern_rc()
ggplotly(g3)
g3 <- ggplot(bills_eb, aes(x = pct_passed, y = eb_estimate, label = `Original Sponsor`, label2 = passed, label3 = not_passed, color = tot_bills, shape = Party)) +
geom_point() +
scale_shape_manual(values = c(3,4))+
scale_color_viridis_c(name = "Total Bills Introduced") +
scale_y_continuous(labels = scales::percent) +
scale_x_continuous(labels = scales::percent) +
labs(title = "Overall Bill Passage",
y = "Bayesian estimate",
x = "Observed percentage of bills passed") +
geom_abline(intercept = 0, slope = 1, color = "lightgray", alpha = .5) +
theme_modern_rc()
ggplotly(g3)
g3 <- ggplot(bills_eb, aes(x = pct_passed, y = eb_estimate, label = `Original Sponsor`, label2 = passed, label3 = not_passed, color = tot_bills, shape = Party)) +
geom_point() +
scale_shape_manual(values = c(22,23))+
scale_color_viridis_c(name = "Total Bills Introduced") +
scale_y_continuous(labels = scales::percent) +
scale_x_continuous(labels = scales::percent) +
labs(title = "Overall Bill Passage",
y = "Bayesian estimate",
x = "Observed percentage of bills passed") +
geom_abline(intercept = 0, slope = 1, color = "lightgray", alpha = .5) +
theme_modern_rc()
ggplotly(g3)
g3 <- ggplot(bills_eb, aes(x = pct_passed, y = eb_estimate, label = `Original Sponsor`, label2 = passed, label3 = not_passed, color = tot_bills, shape = Party)) +
geom_point() +
scale_shape_manual(values = c(0,5))+
scale_color_viridis_c(name = "Total Bills Introduced") +
scale_y_continuous(labels = scales::percent) +
scale_x_continuous(labels = scales::percent) +
labs(title = "Overall Bill Passage",
y = "Bayesian estimate",
x = "Observed percentage of bills passed") +
geom_abline(intercept = 0, slope = 1, color = "lightgray", alpha = .5) +
theme_modern_rc()
ggplotly(g3)
g3 <- ggplot(bills_eb, aes(x = pct_passed, y = eb_estimate, label = `Original Sponsor`, label2 = passed, label3 = not_passed, color = tot_bills, fill = tot_bills, shape = Party)) +
geom_point() +
scale_shape_manual(values = c(0,5))+
scale_color_viridis_c(name = "Total Bills Introduced") +
scale_fill_viridis_c()+
scale_y_continuous(labels = scales::percent) +
scale_x_continuous(labels = scales::percent) +
labs(title = "Overall Bill Passage",
y = "Bayesian estimate",
x = "Observed percentage of bills passed") +
geom_abline(intercept = 0, slope = 1, color = "lightgray", alpha = .5) +
theme_modern_rc()
ggplotly(g3)
g3 <- ggplot(bills_eb, aes(x = pct_passed, y = eb_estimate, label = `Original Sponsor`, label2 = passed, label3 = not_passed, color = tot_bills, shape = Party)) +
geom_point() +
scale_shape_manual(values = c(0,5))+
scale_color_viridis_c(name = "Total Bills Introduced") +
scale_y_continuous(labels = scales::percent) +
scale_x_continuous(labels = scales::percent) +
labs(title = "Overall Bill Passage",
y = "Bayesian estimate",
x = "Observed percentage of bills passed") +
geom_abline(intercept = 0, slope = 1, color = "lightgray", alpha = .5) +
theme_modern_rc()
ggplotly(g3)
g3 <- ggplot(bills_eb, aes(x = pct_passed, y = eb_estimate, label = `Original Sponsor`, label2 = passed, label3 = not_passed, color = tot_bills, shape = Party)) +
geom_point() +
scale_color_viridis_c(name = "Total Bills Introduced") +
scale_y_continuous(labels = scales::percent) +
scale_x_continuous(labels = scales::percent) +
labs(title = "Overall Bill Passage",
y = "Bayesian estimate",
x = "Observed percentage of bills passed") +
geom_abline(intercept = 0, slope = 1, color = "lightgray", alpha = .5) +
theme_modern_rc()
ggplotly(g3)
blogdown:::serve_site()
library(htmlwidgets)
?dir.create
blogdown:::new_post_addin()
blogdown:::serve_site()
install.packages("widgetframe")
library(widgetframe)
blogdown:::serve_site()
# Chunk 1
library(tidyverse)
library(here)
library(stats4)
library(VGAM)
library(kableExtra)
library(plotly)
library(hrbrthemes)
library(widgetframe)
bill_data <- read_csv(here("static/data/session_data.csv"))
party_data <- read_csv(here("static/data/leg_rosters.csv"))
bill_data <- bill_data %>%
separate(Bill, c("prefix", "bill_number"), sep = " ") %>% #seperate e.g. HB 1065 into components
mutate(billpassed = if_else(Status == "Del to Gov" | startsWith(Status, "C"),"passed", "not_passed")) %>% #filter for bills that passed
distinct() %>% #removes house of origin duplicates
left_join(party_data, by = c("Original Sponsor" = "Member Name")) %>% #join by party affiliation
select(bill_number, Status, Title,`Original Sponsor`, billpassed, Party) %>%
filter(`Original Sponsor` != "People of the State of Washington") %>%  #not including initiatives, sorry Tim Eyman
mutate(Party = as.factor(Party))
sponsor_record <- bill_data %>%
count(`Original Sponsor`, billpassed, Party) %>%
spread(billpassed, n) %>%
mutate(passed = replace_na(passed, 0),
not_passed = replace_na(not_passed, 0),
tot_bills = passed + not_passed,
pct_passed = passed / (tot_bills))
billsgraph <- ggplot(sponsor_record, aes(x = passed, y = not_passed, color = Party, label = `Original Sponsor`))+
geom_jitter() +
labs(title = "Overall Bill Passage",
y = "Bills not passing",
x = "Bills passing") +
theme_modern_rc() +
scale_color_manual(breaks = c("D", "R"),
values=c("blue", "red"))
g <- ggplotly(billsgraph)
frameWidget(g)
# Chunk 2
#prior estimation
hist(sponsor_record$pct_passed)
# Chunk 3
# log-likelihood function
ll <- function(alpha, beta) {
x <- sponsor_record$passed
total <- sponsor_record$tot_bills
-sum(VGAM::dbetabinom.ab(x, total, alpha, beta, log = TRUE))
}
# maximum likelihood estimation
m <- mle(ll, start = list(alpha = 1, beta = 10), method = "L-BFGS-B", lower = c(0.0001, .1))
ab <- coef(m)
alpha0 <- ab[1]
beta0 <- ab[2]
z <- seq(0,1,length=21)
beta_dist <- data.frame(cbind(z, dbeta(z,alpha0,beta0)))
colnames(beta_dist) <- c("x", "value")
bills_eb <- sponsor_record %>%
mutate(eb_estimate = (passed + alpha0) / (tot_bills + alpha0 + beta0),
delta = pct_passed-eb_estimate) %>%
arrange(eb_estimate) %>%
mutate(`Original Sponsor` = as.factor(`Original Sponsor`))
g3 <- ggplot(bills_eb, aes(x = pct_passed, y = eb_estimate, label = `Original Sponsor`, label2 = passed, label3 = not_passed, color = tot_bills, shape = Party)) +
geom_point() +
scale_color_viridis_c(name = "Total Bills Introduced") +
scale_y_continuous(labels = scales::percent) +
scale_x_continuous(labels = scales::percent) +
labs(title = "Overall Bill Passage",
y = "Bayesian estimate",
x = "Observed percentage of bills passed") +
geom_abline(intercept = 0, slope = 1, color = "lightgray", alpha = .5) +
theme_modern_rc()
g1 <- ggplotly(g3)
frameWidget(g1)
blogdown:::serve_site()
blogdown:::serve_site()
kable(bills_eb)
library(tidyverse)
library(here)
library(stats4)
library(VGAM)
library(kableExtra)
library(plotly)
library(hrbrthemes)
library(widgetframe)
bill_data <- read_csv(here("static/data/session_data.csv"))
party_data <- read_csv(here("static/data/leg_rosters.csv"))
bill_data <- bill_data %>%
separate(Bill, c("prefix", "bill_number"), sep = " ") %>% #seperate e.g. HB 1065 into components
mutate(billpassed = if_else(Status == "Del to Gov" | startsWith(Status, "C"),"passed", "not_passed")) %>% #filter for bills that passed
distinct() %>% #removes house of origin duplicates
left_join(party_data, by = c("Original Sponsor" = "Member Name")) %>% #join by party affiliation
select(bill_number, Status, Title,`Original Sponsor`, billpassed, Party) %>%
filter(`Original Sponsor` != "People of the State of Washington") %>%  #not including initiatives, sorry Tim Eyman
mutate(Party = as.factor(Party))
sponsor_record <- bill_data %>%
count(`Original Sponsor`, billpassed, Party) %>%
spread(billpassed, n) %>%
mutate(passed = replace_na(passed, 0),
not_passed = replace_na(not_passed, 0),
tot_bills = passed + not_passed,
pct_passed = passed / (tot_bills))
billsgraph <- ggplot(sponsor_record, aes(x = passed, y = not_passed, color = Party, label = `Original Sponsor`))+
geom_jitter() +
labs(title = "Overall Bill Passage",
y = "Bills not passing",
x = "Bills passing") +
theme_modern_rc() +
scale_color_manual(breaks = c("D", "R"),
values=c("blue", "red"))
g <- ggplotly(billsgraph)
frameWidget(g)
#prior estimation
hist(sponsor_record$pct_passed)
# log-likelihood function
ll <- function(alpha, beta) {
x <- sponsor_record$passed
total <- sponsor_record$tot_bills
-sum(VGAM::dbetabinom.ab(x, total, alpha, beta, log = TRUE))
}
# maximum likelihood estimation
m <- mle(ll, start = list(alpha = 1, beta = 10), method = "L-BFGS-B", lower = c(0.0001, .1))
ab <- coef(m)
alpha0 <- ab[1]
beta0 <- ab[2]
z <- seq(0,1,length=21)
beta_dist <- data.frame(cbind(z, dbeta(z,alpha0,beta0)))
colnames(beta_dist) <- c("x", "value")
bills_eb <- sponsor_record %>%
mutate(eb_estimate = (passed + alpha0) / (tot_bills + alpha0 + beta0),
delta = pct_passed-eb_estimate) %>%
arrange(eb_estimate) %>%
mutate(`Original Sponsor` = as.factor(`Original Sponsor`))
g3 <- ggplot(bills_eb, aes(x = pct_passed, y = eb_estimate, label = `Original Sponsor`, label2 = passed, label3 = not_passed, color = tot_bills, shape = Party)) +
geom_point() +
scale_color_viridis_c(name = "Total Bills Introduced") +
scale_y_continuous(labels = scales::percent) +
scale_x_continuous(labels = scales::percent) +
labs(title = "Overall Bill Passage",
y = "Bayesian estimate",
x = "Observed percentage of bills passed") +
geom_abline(intercept = 0, slope = 1, color = "lightgray", alpha = .5) +
theme_modern_rc()
g1 <- ggplotly(g3)
frameWidget(g1)
kable(bills_eb)
kable(head(bills_eb))
kable(tail(bills_eb))
bills_eb <- bills_eb %>%
arrange(desc(eb_estimate))
kable(tail(bills_eb))
kable(head(bills_eb))
blogdown:::serve_site()
